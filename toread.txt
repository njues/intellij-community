try to do some hacking, implementing some refactorings.